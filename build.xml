<project name="jzarinpal" basedir="." default="validate">

 <property name="jzarinpaldir" value="${basedir}"/>
 <property file="${jzarinpaldir}/build.properties" />
 <property name="BuildPropsDotJava" value="${jzarinpaldir}/jzarinpal-domain/src/main/java/mars/jzarinpal/domain/build/BuildProps.java"/>

 <target name="validate" depends="checkProp, copyConfig"/>

 <target name="checkProp" depends="checkBuildDotPropertiesExists"
                           unless="${buildDotPropertiesExists}">
  <echo>Copying build.properties-template to build.properties</echo>
  <copy file="${jzarinpaldir}/build.properties-template"
      tofile="${jzarinpaldir}/build.properties" verbose="yes"/>
 </target>

 <target name="copyConfig" depends="checkProp">
  <!-- Copy log4j.xml-->
  <copy file="${BuildPropsDotJava}-template"
      tofile="${BuildPropsDotJava}" overwrite="true" />
  <replace file="${BuildPropsDotJava}"
      token="@EDIT-WARNING-NOTE@" value="Do not edit this file directly!, modify BuildProps.java-template instead."/>
  <replace file="${BuildPropsDotJava}"
      token="@MERCHANT-ID@" value="${merchantID}"/>
  <replace file="${BuildPropsDotJava}"
      token="@IS-PROD-SERVER@" value="${isProdServer}"/>
  <replace file="${BuildPropsDotJava}"
      token="@SERVICE-BASE-URI@" value="${serviceBaseUri}"/>
  <replace file="${BuildPropsDotJava}"
      token="@DEFAULT-CALLBACK-URI@" value="${defaultCallbackUri}"/>
 </target>

 <target name="checkBuildDotPropertiesExists">
  <available property="buildDotPropertiesExists"
                 file="${jzarinpaldir}/build.properties"/>
 </target>

</project>